# –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ TOLSTOVKA –¥–ª—è Telegram Mini App

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏

### üü¢ **–û–°–ù–û–í–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´**

#### 1. Telegram Bot
- ‚úÖ –§–∞–π–ª `server/bot.js` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Telegraf v4.16.3
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ Web App –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTTPS –∏ HTTP —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è**: –£–∫–∞–∑–∞—Ç—å BOT_TOKEN –≤ `.env` —Ñ–∞–π–ª–µ

#### 2. Web Application
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω Telegram Web App JS SDK (`telegram-web-app.js`)
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è mobile-first –≤–µ—Ä—Å—Ç–∫–∞
- ‚úÖ SPA –Ω–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–∞–π–ø–∞ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram

#### 3. Backend Server
- ‚úÖ Express.js —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 8080
- ‚úÖ API endpoints –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Ç–æ–≤–∞—Ä–æ–≤, –±–∞–Ω–Ω–µ—Ä–æ–≤
- ‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (better-sqlite3)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ (multer)
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

#### 4. –î–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ Seed –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –±–∞–Ω–Ω–µ—Ä–æ–≤

### üü° **–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞
- ‚úÖ `.env` —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
- ‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**:
  - `BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
  - `BASE_URL` - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `http://localhost:8080`
  - `SESSION_SECRET` - —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - `MANAGER_USERNAME` - username –º–µ–Ω–µ–¥–∂–µ—Ä–∞

#### Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é (`ops/DEPLOY.md`)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx (`ops/nginx.conf`)
- ‚úÖ Systemd —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- ‚ö†Ô∏è **–î–ª—è production —Ç—Ä–µ–±—É–µ—Ç—Å—è**:
  - HTTPS –¥–æ–º–µ–Ω (–¥–ª—è Web App –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)
  - –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π VPS/—Å–µ—Ä–≤–µ—Ä

### üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø –î–õ–Ø TELEGRAM**

1. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è Production**
   - Telegram Mini Apps —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HTTPS
   - –õ–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ –≤ @BotFather**
   - –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Menu Button -> —É–∫–∞–∑–∞—Ç—å URL –≤–∞—à–µ–≥–æ Web App
   - (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Bot Domain

3. **Web App Manifest**
   - Viewport meta tag ‚úÖ
   - Mobile-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω ‚úÖ
   - –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ ‚úÖ

## üìã –®–ê–ì–ò –î–õ–Ø –ó–ê–ü–£–°–ö–ê

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
cd server
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env, –¥–æ–±–∞–≤—å—Ç–µ BOT_TOKEN

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
npm run dev

# 4. –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
npm run start:bot

# 5. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram –∏ –Ω–∞–∂–º–∏—Ç–µ /start
```

### Production –¥–µ–ø–ª–æ–π:

1. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ `ops/DEPLOY.md`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω –∏ SSL
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ systemd –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –∫–∞–∫ reverse proxy

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: 
   - Web App –∫–Ω–æ–ø–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ HTTPS
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fallback –Ω–∞ –æ–±—ã—á–Ω—É—é —Å—Å—ã–ª–∫—É

2. **–ü–ª–∞—Ç–µ–∂–∏**: 
   - –°–µ–π—á–∞—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ —Å–≤—è–∑—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
   - Telegram Payments API –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**:
   - –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–∞—Ö
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º

## üöÄ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ó–ê–ü–£–°–ö–£

### –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø: ‚úÖ –ì–û–¢–û–í
- –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
- UI/UX –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

### –î–õ–Ø PRODUCTION: ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –ù–ê–°–¢–†–û–ô–ö–ê
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å production —Å–µ—Ä–≤–µ—Ä
- –ü–æ–ª—É—á–∏—Ç—å HTTPS –¥–æ–º–µ–Ω
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å production .env
- –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ DEPLOY.md

## üìû –ö–û–ù–¢–ê–ö–¢–´

–ú–µ–Ω–µ–¥–∂–µ—Ä: @dmitriy_mityuk